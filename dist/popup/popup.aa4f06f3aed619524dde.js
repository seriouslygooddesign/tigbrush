(()=>{"use strict";class e{constructor(e){this.popup=e,this.main=this.popup.querySelector("[data-popup-main]"),this.togglerOpenSelectors=this.popup.dataset.popupTriggerSelector,this.togglersOpen=this.togglerOpenSelectors&&this.isValidSelector(this.togglerOpenSelectors)?document.querySelectorAll(this.togglerOpenSelectors):[],this.togglersClose=this.popup.querySelectorAll("[data-popup-toggler-close]"),this.focusableElements=this.getFocusableElements(),this.firstFocusableElement=this.focusableElements[0],this.lastFocusableElement=this.focusableElements[this.focusableElements.length-1],this.activeClass="active",this.popupOpenedBy=void 0;const t=window.location.hash;t&&this.togglersOpen.forEach((e=>{const s=e.hash;s&&s===t&&this.popupShow()})),this.togglersOpen.length&&this.togglersOpen.forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault(),this.popupShow(),this.popupOpenedBy=e}))})),this.togglersOpen.length&&this.togglersClose.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),this.popupClose()}))})),document.addEventListener("keydown",(e=>{"Escape"===e.key&&this.popupClose()})),this.popup.addEventListener("click",(()=>{this.popupClose()})),this.main.addEventListener("click",(e=>{e.stopPropagation()}))}isValidSelector(e){try{document.querySelectorAll(e)}catch(e){if(e instanceof DOMException)return!1}return!0}isActive(){return!!this.popup.classList.contains(this.activeClass)}focusTrap(){this.popup.addEventListener("keydown",(e=>{"Tab"!==e.key&&9!==e.keyCode||(e.shiftKey?document.activeElement===this.firstFocusableElement&&(e.preventDefault(),this.lastFocusableElement.focus()):document.activeElement===this.lastFocusableElement&&(e.preventDefault(),this.firstFocusableElement.focus()))}))}getFocusableElements(){return Array.from(this.popup.querySelectorAll('a[href], button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])')).filter((e=>!e.hasAttribute("disabled")&&!e.getAttribute("aria-hidden")&&"hidden"!==e.type))}popupShow(){this.isActive()||(this.popup.classList.add(this.activeClass),this.popup.scrollTo(0,0),this.popup.addEventListener("transitionend",(e=>{e.target===this.popup&&this.isActive()&&this.firstFocusableElement.focus()})),this.focusTrap())}popupClose(){this.isActive()&&(this.popup.classList.remove(this.activeClass),this.popupOpenedBy?.focus({preventScroll:!0}))}}document.querySelectorAll("[data-popup]").forEach((t=>{new e(t)}))})();
//# sourceMappingURL=popup.aa4f06f3aed619524dde.js.map